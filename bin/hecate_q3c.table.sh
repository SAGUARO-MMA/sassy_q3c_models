#!/bin/sh

# +
# $1 = database host
# $2 = database port
# $3 = database name
# $4 = database username
# $5 = database password
# -

PGPASSWORD=${5} psql --echo-all -h ${1} -p ${2} -U ${4} -d ${3} << END_TABLE
DROP TABLE IF EXISTS hecate_q3c;
CREATE TABLE hecate_q3c (
  hid serial PRIMARY KEY,
  pgc integer,
  objname VARCHAR(64),
  id_ned VARCHAR(64),
  id_nedd VARCHAR(64),
  id_iras VARCHAR(64),
  id_2mass VARCHAR(64),
  sdss_photid VARCHAR(64),
  sdss_specid VARCHAR(64),
  ra double precision,
  dec double precision,
  f_astrom integer,
  r1 double precision,
  r2 double precision,
  pa double precision,
  rsource VARCHAR(1),
  rflag integer,
  t double precision,
  e_t double precision,
  incl double precision,
  v double precision,
  e_v double precision,
  v_vir double precision,
  e_v_vir double precision,
  ndist integer,
  edist boolean,
  d double precision,
  e_d double precision,
  d_lo68 double precision,
  d_hi68 double precision,
  d_lo95 double precision,
  d_hi95 double precision,
  dmethod VARCHAR(2),
  ut double precision,
  bt double precision,
  vt double precision,
  it double precision,
  e_ut double precision,
  e_bt double precision,
  e_vt double precision,
  e_it double precision,
  ag double precision,
  ai double precision,
  s12 double precision,
  s25 double precision,
  s60 double precision,
  s100 double precision,
  q12 double precision,
  q25 double precision,
  q60 double precision,
  q100 double precision,
  wf1 double precision,
  wf2 double precision,
  wf3 double precision,
  wf4 double precision,
  e_wf1 double precision,
  e_wf2 double precision,
  e_wf3 double precision,
  e_wf4 double precision,
  wfpoint boolean,
  wftreat boolean,
  j double precision,
  h double precision,
  k double precision,
  e_j double precision,
  e_h double precision,
  e_k double precision,
  flag_2mass integer,
  u double precision,
  g double precision,
  r double precision,
  i double precision,
  z double precision,
  e_u double precision,
  e_g double precision,
  e_r double precision,
  e_i double precision,
  e_z double precision,
  logl_tir double precision,
  logl_fir double precision,
  logl_60u double precision,
  logl_12u double precision,
  logl_22u double precision,
  logl_k double precision,
  ml_ratio double precision,
  logsfr_tir double precision,
  logsfr_fir double precision,
  logsfr_60u double precision,
  logsfr_12u double precision,
  logsfr_22u double precision,
  logsfr_hec double precision,
  sfr_hec_flag VARCHAR(2),
  logm_hec double precision,
  logsfr_gsw double precision,
  logm_gsw double precision,
  min_snr double precision,
  metal double precision,
  flag_metal integer,
  class_sp integer,
  agn_s17 VARCHAR(1),
  agn_hec VARCHAR(1));
END_TABLE
PGPASSWORD=${5} psql --echo-all -h ${1} -p ${2} -U ${4} -d ${3} << END_Q3C
  CREATE INDEX ON hecate_q3c (q3c_ang2ipix(ra, dec));
  CLUSTER hecate_q3c_q3c_ang2ipix_idx ON hecate_q3c;
  ANALYZE VERBOSE hecate_q3c;
END_Q3C
